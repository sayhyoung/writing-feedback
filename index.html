<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Writing Assistant</title>
  <style>
    /* Base & Layout */
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background-color: #f0f4f8;
      color: #1a1a1a;
      margin: 0;
      padding: 2rem;
      display: flex;
      justify-content: center;
      line-height: 1.6;
    }
    #container {
      width: 100%;
      max-width: 700px;
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 2rem;
      position: relative;
    }
    h1 {
      color: #004a99;
      text-align: center;
      margin-bottom: 0.5rem;
    }

    /* Reset button under heading, right-aligned */
    #reset-btn {
      background-color: #ffffff;
      color: #0066cc;
      border: 1px solid #0066cc;
      border-radius: 4px;
      padding: 0.5rem 1rem;
      cursor: pointer;
      display: block;
      margin: 0 0 1rem auto;
      transition: background-color 0.2s ease;
    }
    #reset-btn:hover {
      background-color: #e9f5ff;
    }

    /* Form */
    form {
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
    }
    label {
      display: block;
      margin: 0.75rem 0 0.25rem;
      font-weight: 600;
      color: #004a99;
    }
    input[type="text"],
    select,
    textarea,
    input[type="file"] {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #cbd7e0;
      border-radius: 4px;
      background: #f9fcff;
      font-size: 1rem;
      box-sizing: border-box;
    }
    textarea { resize: vertical; }

    /* Buttons */
    button {
      background-color: #0066cc;
      color: #ffffff;
      border: none;
      border-radius: 4px;
      padding: 0.75rem 1.5rem;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.2s ease;
      margin-top: 1rem;
    }
     button + button {
       margin-left: 0.5rem;
       margin-top: 1rem; /* Ensure vertical consistency */
     }
    button:hover {
      background-color: #0052a3;
    }
    .spinner {
      display: none;
      width: 16px;
      height: 16px;
      border: 2px solid #FF5722;
      border-top: 2px solid transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      vertical-align: middle;
      margin-left: 0.5rem;
    }


    @keyframes spin { to { transform: rotate(360deg); } }

    /* Result Boxes - Removed left border */
    .box {
      background: #e9f5ff;
      border-radius: 4px;
      padding: 1rem;
      margin-top: 1rem;
    }
    .model-box {
      background: #ffffff;
      padding: 1rem;
      border-radius: 4px;
      margin-top: 0.5rem;
      font-size: 1.1rem;
      line-height: 1.5;
    }

    /* Action controls spacing */
    #result button,
    #result a#download-link {
      display: inline-block;
      margin-top: 1.5rem;
      margin-right: 1rem;
    }
     #result a#download-link { /* Ensure download link is correctly hidden */
         display: none;
     }
    #result button:last-child,
    #result a#download-link:last-child {
        margin-right: 0;
    }

    /* Ensure TTS and Print buttons have same height */
    #tts-btn,
    #print-btn {
        height: 2.5rem; /* 명시적인 높이 설정 */
        box-sizing: border-box;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 0.75rem 1.5rem; /* 기존 패딩 유지 */
    }
     #tts-btn .spinner,
     #print-btn .spinner {
         flex-shrink: 0;
         margin-left: 0.5rem;
     }

    /* Hide download link until TTS completes */
    #download-link {
      display: none;
      color: #0066cc;
      text-decoration: none;
      font-weight: 600;
    }

     /* Print Options Modal */
    .print-options {
        margin-top: 1.5rem;
        padding: 1rem;
        border: 1px solid #cbd7e0;
        border-radius: 4px;
        background: #f9fcff;
        display: none; /* Hidden by default */
    }
    .print-options label {
        display: inline-block;
        margin-right: 1rem;
        font-weight: normal;
    }

    /* Print & Media - Original Template Styles */
    @media print {
      #submit-btn, #tts-btn, #print-btn, #reset-btn, .print-options { display: none !important; }
      body { background: #ffffff; margin: 0; font-family: sans-serif; } /* Ensure print body style */

      /* Styles for the original print template structure */
      .print-header {
        text-align: center;
        margin-bottom: 1.5cm;
        margin-top: 0; /* 로고를 위로 올리기 위해 추가 */
      }
      .print-header img {
        max-height: 80px;
        margin-bottom: 0.5rem;
      }
      .print-header h2 {
        margin: 0;
        font-size: 1.4rem;
        color: #004a99;
      }
      .print-header p {
        margin-top: 0.5rem;
      }
      .print-section { /* 메인 내용 섹션 - 원래 템플릿의 점선 테두리 */
        margin-top: 1cm;
        padding: 1cm;
        border: 2px dashed #0066cc;
        min-height: 10cm; /* 원래 템플릿의 최소 높이 */
      }
       /* 내용이 길어도 첫 페이지부터 시작되도록 section의 page-break-inside 제거 */
       header { page-break-inside: avoid; }
       section { page-break-inside: auto; } /* 섹션 내에서 자연스럽게 페이지 나눔 허용 */


       /* 개별 피드백/수정글 항목 스타일 (선택 사항이나 유지) */
        .print-content-item {
            margin-bottom: 1cm;
            padding-bottom: 1cm;
            border-bottom: 1px dashed #ccc;
       }
       .print-content-item:last-child {
           margin-bottom: 0;
           padding-bottom: 0;
           border-bottom: none;
       }
        .print-content-item
